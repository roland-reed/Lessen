require.config({paths:{vue:"https://cdn.bootcss.com/vue/1.0.24/vue.min",reqwest:"https://cdn.bootcss.com/reqwest/2.0.5/reqwest.min",qwery:"https://cdn.bootcss.com/qwery/4.0.0/qwery.min"}}),require(["vue","qwery","reqwest"],function(t,e,a){function n(){r.toastMsg="无法连接网络",r.toast=!0,setTimeout(function(){r.toast=!1},3e3)}t.filter("timeFormat",function(t){if(!t)return"";var e,a,n=(""+t).split(""),r=n.length,i=["","周一","周二","周三","周四","周五","周六","周日"];return e=i[parseInt(n[0])],3===r?a=n[2]:5===r&&(a=" "+n[2]+"、"+parseInt(n[3]+n[4])+" 节"),e+a}),t.filter("typeFormat",function(t){var e=["暂无数据","社会科学与人类发展","传统文化与世界文明","医学与生命科学","人文学科与艺术审美","自然科学与现代技术"];return e[parseInt(t)]}),t.filter("rollFormat",function(t){var e=["暂无数据","频繁点名","经常点名","偶尔点名","从不点名"];return e[parseInt(t)]}),t.filter("examFormat",function(t){var e=["暂无数据","闭卷考试","开卷考试","论文"];return e[parseInt(t)]}),t.filter("teacherScoreFormat",function(t){return isNaN(t)?"":t/100});var r=new t({el:"#app",data:{top:!0,detail:!1,filter:!1,search:!1,help:!1,rating:!1,title:!0,searchBox:!1,searchBtn:!0,toast:!1,toastMsg:"",currentPage:"top",previousPage:"top",headExpand:{"head-expand":!0},bodyExpand:{"body-expand":!0},detailBack:{"detail-back":!1},currentPageTitle:"排行榜",pageTitle:{top:"排行榜",filter:"筛选",search:"搜索",help:"帮助",rating:"评分",detail:"详细信息"},headBg:{"background-color":"#db4437"},headBgColors:{top:"#db4437",filter:"#03a9f4",search:"#455a64",help:"#0f9d58",rating:"#ffa000",detail:"#785447"},nav:{"nav-hide":!0},mask:!1,tops:null,filters:null,filtering:!1,filterEmpty:!1,searchs:null,searching:!1,searchEmpty:!1,detailData:{},detailFetching:!1,ratingSelected:{},ratingSearchs:null,ratingSearching:!1,ratingSearchEmpty:!1,gettingDetail:!1,teacherScore:10},computed:{detailBack:function(){return{"detail-back":this.detail}}},methods:{showNav:function(t){if(t.target.classList.contains("detail-back")){var a,n,r=e("li",e(".nav")[0]);for(a=0,n=r.length;n>a;a++)r[a].getAttribute("data-page")===this.previousPage&&e(".nav-title",r[a])[0].click()}else this.nav["nav-hide"]=!1,this.mask=!0},hideNav:function(){this.nav["nav-hide"]=!0,this.mask=!1},changePage:function(t){var e=this,a=/search/.test(t.target.className)?"search":t.target.parentNode.getAttribute("data-page");this[this.currentPage]=!1,this.previousPage=this.currentPage,this.hideNav(),"search"===a?setTimeout(function(){e.title=!1,e.searchBtn=!1,e.searchBox=!0},300):(e.title=!0,e.searchBtn=!0,e.searchBox=!1),setTimeout(function(){e[a]=!0,e.currentPage=a,e.currentPageTitle=e.pageTitle[a],e.headBg["background-color"]=e.headBgColors[a],"top"===a?(e.headExpand["head-expand"]=!0,e.bodyExpand["body-expand"]=!0):(e.headExpand["head-expand"]=!1,e.bodyExpand["body-expand"]=!1)},300)},toggleOption:function(t){var a,n,r=t.target;if(r.classList.contains("option")){for(a=e(".option",r.parentNode),n=a.length-1;n>=0;n--)a[n].classList.remove("option-active");r.classList.add("option-active")}},filterDone:function(t){var i,o,s,c=e(".option-active"),h=t.target,d=h.innerText,u=[];for(i=0,o=c.length;o>i;i++)u.push(c[i].getAttribute("data-option"));this.filters=null,this.filtering=!0,this.filterEmpty=!1,s=u.join("&"),h.innerText="正在筛选...",a({url:"api/?action=filter&t="+Math.random(),method:"post",data:s,type:"json",success:function(t){r.filtering=!1,h.innerText=d,0===t.count?(r.filterEmpty=!0,r.toastMsg="抱歉，没有符合条件的结果",r.toast=!0,setTimeout(function(){r.toast=!1},3e3)):(r.filters=t.data,r.toastMsg="向上滑动来查看"+t.count+"条结果",r.toast=!0,setTimeout(function(){r.toast=!1},3e3))},error:function(){n(),t.target.innerText=d}})},teacherScoreChange:function(t){this.teacherScore=t.target.value},ratingSubmit:function(t){var i,o,s,c=e(".option-active",t.target.parentNode),h=t.target.innerText,d=[];for(o=0,s=c.length;s>o;o++)d.push(c[o].getAttribute("data-option"));d.push("teacherScore="+this.teacherScore),d.push("comment="+e("#rating-comment")[0].innerText),d.push("code="+this.ratingSelected.code),i=d.join("&"),t.target.innerText="正在提交...",a({url:"api/?action=rate&t="+Math.random(),method:"post",data:i,type:"json",success:function(){e("#rating-search-input")[0].value="",r.ratingSearchs={},t.target.innerText=h,r.ratingSelected={code:"",name:"",teacher:"",time:"",type:""},r.toastMsg="评价成功",r.toast=!0,setTimeout(function(){r.toast=!1},3e3)},error:function(){n(),t.target.innerText=h}})},tabSwitch:function(t){var i,o,s=t.target.parentNode,c=e("li",s),h=t.target.getAttribute("data-type");for(i=0,o=c.length;o>i;i++)c[i].classList.remove("tab-li-current");t.target.classList.add("tab-li-current"),this.tops=null,a({url:"api/?action=top&type="+h+"&t="+Math.random(),method:"get",type:"json",success:function(t){r.tops=t.data},error:function(){n()}})},searchAction:function(t){var e=t.target.value;this.searchs=null,this.searching=!0,this.searchEmpty=!1,t.target.blur(),a({url:"api/?action=search&q="+e+"&t="+Math.random(),method:"get",type:"json",success:function(t){r.searching=!1,0===t.count?r.searchEmpty=!0:(r.searchs=t.data,r.toastMsg="共"+t.count+"条结果",r.toast=!0,setTimeout(function(){r.toast=!1},3e3))},error:function(){n()}})},ratingSearch:function(t){var e,i=t.target.value,o=[];this.ratingSearchs=null,this.ratingSearching=!0,this.ratingSearchEmpty=!1,t.target.blur(),a({url:"api/?action=search&q="+i+"&t="+Math.random(),method:"get",type:"json",success:function(t){r.ratingSearching=!1,t.data.forEach(function(t){e=0,0===o.length?o.push(t):(o.forEach(function(a){t.code===a.code&&t.teacher===a.teacher&&e++}),0===e&&o.push(t))}),0===t.count?r.ratingSearchEmpty=!0:r.ratingSearchs=o},error:function(){n()}})},ratingSelectCourse:function(t){var e,i,o=t.target;for(i=0;3>i;i++)"LI"===o.nodeName.toUpperCase()?e=o.getAttribute("data-id"):o=o.parentNode;this.ratingSelectedId=e,this.gettingDetail=!0,a({url:"api/?action=detail&id="+e+"&t="+Math.random(),method:"get",type:"json",success:function(t){r.gettingDetail=!1,r.ratingSelected=t.data[0]},error:function(){n()}})},showDetail:function(t){var e,i,o=t.target,s=this,c="detail";for(i=0;4>i;i++)"LI"===o.nodeName.toUpperCase()?e=o.getAttribute("data-id"):o=o.parentNode;this.detailData={},this.detailFetching=!0,this[this.currentPage]=!1,this.previousPage=this.currentPage,setTimeout(function(){s.title=!0,s.searchBtn=!0,s.searchBox=!1,s[c]=!0,s.currentPage=c,s.currentPageTitle=s.pageTitle[c],s.headBg["background-color"]=s.headBgColors[c],"top"===c?(s.headExpand["head-expand"]=!0,s.bodyExpand["body-expand"]=!0):(s.headExpand["head-expand"]=!1,s.bodyExpand["body-expand"]=!1)},300),a({url:"api/?action=detail&id="+e+"&t="+Math.random(),method:"get",type:"json",success:function(t){r.detailFetching=!1,r.detailData=t.data[0]},error:function(){n()}})},ratingCourse:function(t){for(var i=t.target.getAttribute("data-id"),o=e("li",e(".nav")[0]),s=0,c=o.length;c>s;s++)"rating"===o[s].getAttribute("data-page")&&e(".nav-title",o[s])[0].click();this.ratingSelectedId=i,this.gettingDetail=!0,a({url:"api/?action=detail&id="+i+"&t="+Math.random(),method:"get",type:"json",success:function(t){r.gettingDetail=!1,r.ratingSelected=t.data[0]},error:function(){n()}})}}});e(".tab-li-current")[0].click()});